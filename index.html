<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Gallery Kenangan <3</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        /* ========== CSS (sama seperti sebelumnya, tidak diubah) ========== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', 'Segoe UI', system-ui, sans-serif;
        }
        body {
            background: linear-gradient(145deg, #fff0f7 0%, #ffe2ed 100%);
            color: #4a2c3a;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        .heart-float {
            position: fixed;
            font-size: 1.8rem;
            user-select: none;
            pointer-events: none;
            z-index: 9999;
            animation: floatHeart 8s linear forwards;
            color: #ff69b4;
            opacity: 0.8;
            filter: drop-shadow(0 0 10px rgba(255,105,180,0.5));
        }
        @keyframes floatHeart {
            0% { transform: translateY(100vh) scale(0.5) rotate(0deg); opacity: 0.8; }
            100% { transform: translateY(-10vh) scale(1.5) rotate(360deg); opacity: 0; }
        }
        .heart-float:nth-child(odd) { color: #ff9ebb; }
        .heart-float:nth-child(3n) { color: #ffb6c1; }
        .heart-float:nth-child(5n) { color: #ff69b4; }
        .heart-float:nth-child(7n) { color: #ff85b3; }
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" opacity="0.1"><path fill="%23ff69b4" d="M50 30c-5-10-20-10-25 0-5 10 5 25 25 35 20-10 30-25 25-35-5-10-20-10-25 0z"/></svg>');
            background-size: 80px 80px;
            animation: backgroundFloat 30s linear infinite;
            z-index: -1;
        }
        @keyframes backgroundFloat {
            0% { transform: translateY(0) rotate(0deg); }
            100% { transform: translateY(-100vh) rotate(360deg); }
        }
        .navbar {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px);
            padding: 15px 30px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 2px solid rgba(255, 182, 193, 0.6);
            box-shadow: 0 10px 30px rgba(255, 105, 180, 0.15);
            position: sticky;
            top: 0;
            z-index: 100;
            animation: slideDown 0.5s ease;
            flex-wrap: wrap;
            gap: 15px;
        }
        @keyframes slideDown {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(135deg, #ff3388, #ff6eb4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 8px;
            animation: smoothGlow 3s ease-in-out infinite;
        }
        @keyframes smoothGlow {
            0% { filter: drop-shadow(0 0 2px #ff69b4); transform: scale(1); }
            50% { filter: drop-shadow(0 0 15px #ff69b4); transform: scale(1.03); }
            100% { filter: drop-shadow(0 0 2px #ff69b4); transform: scale(1); }
        }
        .nav-links {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        .nav-link {
            text-decoration: none;
            padding: 10px 28px;
            border-radius: 60px;
            font-weight: 600;
            transition: 0.3s;
            background: rgba(255, 255, 255, 0.6);
            color: #b34e7a;
            border: 1px solid white;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .nav-link::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transform: translate(-50%, -50%);
            transition: width 0.5s, height 0.5s;
        }
        .nav-link:hover::before {
            width: 200px;
            height: 200px;
        }
        .nav-link.active {
            background: #ff69b4;
            color: white;
            box-shadow: 0 8px 20px rgba(255, 105, 180, 0.5);
            animation: glow 1.5s infinite;
        }
        @keyframes glow {
            0% { box-shadow: 0 0 5px #ff69b4; }
            50% { box-shadow: 0 0 20px #ff69b4; }
            100% { box-shadow: 0 0 5px #ff69b4; }
        }
        .status-mini {
            background: rgba(255, 240, 248, 0.8);
            backdrop-filter: blur(8px);
            padding: 10px 30px;
            display: flex;
            gap: 30px;
            font-size: 0.9rem;
            border-bottom: 1px solid rgba(255, 182, 193, 0.4);
            color: #7a4f66;
            animation: fadeIn 1s ease;
            flex-wrap: wrap;
            justify-content: center;
        }
        .status-mini span {
            display: flex;
            align-items: center;
            gap: 6px;
            background: rgba(255,255,255,0.3);
            padding: 5px 15px;
            border-radius: 40px;
            backdrop-filter: blur(2px);
            transition: 0.3s;
        }
        .status-mini span:hover {
            background: rgba(255,255,255,0.6);
            transform: scale(1.05);
        }
        .status-mini i {
            color: #ff69b4;
            animation: gentleBounce 2s infinite;
        }
        @keyframes gentleBounce {
            0%,100%{ transform: translateY(0); }
            50%{ transform: translateY(-3px); }
        }
        .container {
            padding: 25px 30px;
            max-width: 1400px;
            margin: 0 auto;
        }
        #gallery-page, #dashboard-page {
            display: none;
            animation: pageFade 0.4s ease;
        }
        @keyframes pageFade {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        #gallery-page.active-page, #dashboard-page.active-page {
            display: block;
        }
        .page-title {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(255,255,255,0.5);
            padding: 10px 28px;
            border-radius: 60px;
            width: fit-content;
            backdrop-filter: blur(4px);
            color: #b34e7a;
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 5px 15px rgba(255,105,180,0.2);
            border: 2px solid white;
            transition: all 0.3s;
        }
        .page-title:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(255,105,180,0.4);
        }
        @keyframes popIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        .gallery-inner-tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        .inner-tab {
            background: rgba(255,255,255,0.6);
            backdrop-filter: blur(4px);
            border: 2px solid white;
            padding: 10px 25px;
            border-radius: 60px;
            font-weight: 600;
            color: #b34e7a;
            cursor: pointer;
            transition: 0.3s;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .inner-tab:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 10px 20px rgba(255,105,180,0.3);
        }
        .inner-tab.active {
            background: #ff69b4;
            color: white;
            border-color: #ff69b4;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255,105,180,0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255,105,180,0); }
            100% { box-shadow: 0 0 0 0 rgba(255,105,180,0); }
        }
        .music-player {
            background: rgba(255,255,255,0.7);
            backdrop-filter: blur(10px);
            border-radius: 80px;
            padding: 15px 25px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
            border: 1px solid white;
            box-shadow: 0 10px 30px rgba(255,105,180,0.2);
            animation: gentleFloat 4s infinite ease-in-out;
            position: relative;
            overflow: hidden;
        }
        .music-player::after {
            content: '\f004';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            font-size: 3rem;
            opacity: 0.1;
            right: 10px;
            bottom: -10px;
            transform: rotate(20deg);
            animation: rotateSlow 10s linear infinite;
        }
        @keyframes gentleFloat {
            0% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
            100% { transform: translateY(0); }
        }
        @keyframes rotateSlow {
            from { transform: rotate(20deg); }
            to { transform: rotate(380deg); }
        }
        .music-controls {
            display: flex;
            gap: 15px;
        }
        .music-btn {
            background: #ff69b4;
            color: white;
            border: none;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            font-size: 1.3rem;
            cursor: pointer;
            box-shadow: 0 4px 0 #b34e7a;
            transition: 0.1s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .music-btn:active {
            transform: translateY(4px);
            box-shadow: 0 1px 0 #b34e7a;
        }
        .music-info {
            font-weight: 600;
            color: #b34e7a;
            flex: 1;
            text-align: center;
            animation: textShimmer 3s infinite;
        }
        @keyframes textShimmer {
            0% { text-shadow: 0 0 2px #ff69b4; }
            50% { text-shadow: 0 0 10px #ff69b4; }
            100% { text-shadow: 0 0 2px #ff69b4; }
        }
        .playlist {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }
        .playlist-item {
            background: #ffe2ec;
            padding: 8px 16px;
            border-radius: 40px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .playlist-item:hover {
            background: #ffb6c1;
            transform: scale(1.05) rotate(1deg);
            box-shadow: 0 5px 15px rgba(255,105,180,0.3);
        }
        .playlist-item.active {
            background: #ff69b4;
            color: white;
        }
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
            margin-top: 10px;
        }
        .photo-card {
            background: white;
            border-radius: 28px;
            overflow: hidden;
            box-shadow: 0 18px 30px rgba(255, 130, 160, 0.25);
            transition: 0.4s;
            cursor: pointer;
            border: 3px solid white;
            animation: cardAppear 0.5s;
            position: relative;
        }
        @keyframes cardAppear {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }
        .photo-card:hover {
            transform: translateY(-15px) rotate(1deg) scale(1.02);
            box-shadow: 0 30px 50px rgba(255, 80, 140, 0.5);
        }
        .photo-card .favorite-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255,255,255,0.7);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 1.3rem;
            color: #ff69b4;
            cursor: pointer;
            backdrop-filter: blur(5px);
            transition: 0.3s;
            z-index: 5;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transform: scale(0.8);
        }
        .photo-card:hover .favorite-btn {
            opacity: 1;
            transform: scale(1);
        }
        .favorite-btn:hover {
            background: #ff69b4;
            color: white;
            transform: scale(1.1) rotate(15deg);
        }
        .favorite-btn.active {
            background: #ff69b4;
            color: white;
            opacity: 1;
            transform: scale(1);
        }
        .photo-card img {
            width: 100%;
            aspect-ratio: 1/1;
            object-fit: cover;
            transition: 0.5s;
        }
        .photo-card:hover img {
            transform: scale(1.05);
        }
        .photo-info {
            padding: 14px;
            background: rgba(255, 240, 250, 0.9);
            transition: 0.3s;
            position: relative;
        }
        .photo-card:hover .photo-info {
            background: rgba(255, 220, 240, 0.9);
        }
        .photo-info h4 {
            font-size: 1rem;
            font-weight: 600;
            color: #b34e7a;
        }
        .photo-info p {
            font-size: 0.8rem;
            color: #6b4e5c;
        }
        .empty-message {
            text-align: center;
            padding: 60px;
            background: rgba(255,255,255,0.6);
            border-radius: 50px;
            font-size: 1.3rem;
            color: #ff69b4;
            animation: fadeIn 1s, gentleWiggle 4s infinite;
        }
        @keyframes gentleWiggle {
            0%,100%{ transform: rotate(0deg); }
            25%{ transform: rotate(1deg); }
            75%{ transform: rotate(-1deg); }
        }
        .notes-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .note-card {
            background: rgba(255,255,255,0.8);
            backdrop-filter: blur(10px);
            border-radius: 50px;
            padding: 20px;
            border: 2px solid white;
            box-shadow: 0 10px 20px rgba(255,105,180,0.2);
            animation: slideInRight 0.4s, loveGlow 3s infinite;
            position: relative;
            overflow: hidden;
        }
        .note-card.expired {
            opacity: 0.6;
            filter: grayscale(0.3);
            border-color: #d3b0c0;
        }
        @keyframes loveGlow {
            0% { border-color: white; box-shadow: 0 0 10px rgba(255,105,180,0.2); }
            50% { border-color: #ffb6c1; box-shadow: 0 0 25px #ff69b4; }
            100% { border-color: white; box-shadow: 0 0 10px rgba(255,105,180,0.2); }
        }
        @keyframes slideInRight {
            from { transform: translateX(30px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .note-card::before {
            content: '\f004';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            font-size: 2rem;
            opacity: 0.1;
            right: -10px;
            bottom: -10px;
            transform: rotate(15deg);
            animation: floatHeartNote 5s infinite;
        }
        @keyframes floatHeartNote {
            0% { transform: translateY(0) rotate(15deg); }
            50% { transform: translateY(-10px) rotate(20deg); }
            100% { transform: translateY(0) rotate(15deg); }
        }
        .note-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .note-time {
            font-size: 0.8rem;
            color: #b34e7a;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .note-content {
            font-size: 1.1rem;
            margin-bottom: 10px;
            white-space: pre-wrap;
            position: relative;
            z-index: 2;
        }
        .note-timer {
            font-weight: 600;
            color: #ff69b4;
            background: rgba(255,255,255,0.5);
            padding: 2px 10px;
            border-radius: 40px;
            display: inline-block;
            animation: timerPulse 2s infinite;
        }
        @keyframes timerPulse {
            0% { background: rgba(255,255,255,0.5); }
            50% { background: rgba(255,105,180,0.2); }
            100% { background: rgba(255,255,255,0.5); }
        }
        .note-delete-btn {
            background: none;
            border: none;
            color: #ff8aa8;
            font-size: 1.2rem;
            cursor: pointer;
            transition: 0.2s;
            margin-left: 10px;
        }
        .note-delete-btn:hover {
            color: #ff3b6f;
            transform: scale(1.2) rotate(10deg);
        }
        .create-note {
            background: white;
            border-radius: 50px;
            padding: 25px;
            margin-top: 20px;
            animation: fadeInUp 0.5s;
            border: 2px solid #ffb6c1;
            transition: 0.3s;
        }
        .create-note:hover {
            box-shadow: 0 10px 30px rgba(255,105,180,0.3);
            transform: translateY(-2px);
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .create-note textarea {
            width: 100%;
            border: 2px solid #ffd0df;
            border-radius: 40px;
            padding: 15px;
            font-size: 1rem;
            margin-bottom: 15px;
            transition: 0.3s;
        }
        .create-note textarea:focus {
            border-color: #ff69b4;
            box-shadow: 0 0 0 4px rgba(255,105,180,0.2);
            outline: none;
        }
        .timer-select {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
        }
        .timer-option {
            background: #ffe2ec;
            border: none;
            padding: 8px 16px;
            border-radius: 40px;
            font-weight: 600;
            color: #b34e7a;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .timer-option:hover {
            background: #ffb6c1;
            transform: scale(1.05) rotate(1deg);
            box-shadow: 0 5px 10px rgba(255,105,180,0.2);
        }
        .timer-option.active {
            background: #ff69b4;
            color: white;
        }
        .create-note button {
            background: #ff69b4;
            color: white;
            border: none;
            padding: 14px;
            border-radius: 60px;
            width: 100%;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.2s;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .create-note button:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 10px 20px rgba(255,105,180,0.3);
        }
        .quote-container {
            background: rgba(255,255,255,0.7);
            backdrop-filter: blur(10px);
            border-radius: 70px;
            padding: 40px;
            text-align: center;
            font-size: 1.5rem;
            font-style: italic;
            border: 3px solid white;
            box-shadow: 0 20px 40px rgba(255,105,180,0.2);
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            animation: zoomIn 0.5s, softGlow 3s infinite, gentleFloat 4s infinite;
            position: relative;
        }
        @keyframes softGlow {
            0% { box-shadow: 0 0 10px #ffb6c1; }
            50% { box-shadow: 0 0 30px #ff69b4; }
            100% { box-shadow: 0 0 10px #ffb6c1; }
        }
        @keyframes gentleFloat {
            0% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
            100% { transform: translateY(0); }
        }
        @keyframes zoomIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        .quote-container i {
            font-size: 3rem;
            margin-bottom: 10px;
            animation: heartBeat 2s infinite;
        }
        @keyframes heartBeat {
            0% { transform: scale(1); }
            25% { transform: scale(1.1); }
            50% { transform: scale(1); }
            75% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .quote-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        .new-quote-btn, .copy-quote-btn {
            background: #ff69b4;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 60px;
            font-weight: 600;
            font-size: 1.1rem;
            cursor: pointer;
            transition: 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .new-quote-btn:hover, .copy-quote-btn:hover {
            transform: rotate(2deg) scale(1.05);
            box-shadow: 0 15px 30px rgba(255,105,180,0.4);
        }
        .copy-quote-btn {
            background: #ff8eb5;
        }
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
        }
        .card {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(12px);
            border-radius: 48px;
            padding: 25px;
            box-shadow: 0 20px 35px rgba(255, 130, 160, 0.2);
            border: 1px solid rgba(255,255,255,0.9);
            transition: 0.3s;
            animation: cardFade 0.6s;
            position: relative;
            overflow: hidden;
        }
        .card:hover {
            transform: translateY(-5px) scale(1.01);
            box-shadow: 0 30px 45px rgba(255,105,180,0.3);
        }
        .card::after {
            content: '\f004';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            font-size: 4rem;
            opacity: 0.05;
            right: -20px;
            bottom: -20px;
            transform: rotate(20deg);
            animation: rotateSuperSlow 20s infinite;
        }
        @keyframes rotateSuperSlow {
            from { transform: rotate(20deg); }
            to { transform: rotate(380deg); }
        }
        @keyframes cardFade {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .card-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #b34e7a;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .stats-row {
            display: flex;
            justify-content: space-around;
            gap: 10px;
            flex-wrap: wrap;
        }
        .stat-item {
            background: white;
            padding: 15px;
            border-radius: 40px;
            min-width: 100px;
            text-align: center;
            box-shadow: 0 4px 0 #ffb6c1;
            transition: 0.2s;
        }
        .stat-item:hover {
            transform: scale(1.05) translateY(-3px);
            box-shadow: 0 6px 0 #ff69b4;
        }
        .stat-value {
            font-size: 2.2rem;
            font-weight: 700;
            color: #ff69b4;
            line-height: 1.2;
        }
        .stat-label {
            font-size: 0.75rem;
            color: #7a4f66;
        }
        .chart-container {
            height: 200px;
            margin-top: 10px;
        }
        .recent-list {
            list-style: none;
            max-height: 250px;
            overflow-y: auto;
        }
        .recent-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255,105,180,0.2);
            animation: listItem 0.3s;
        }
        @keyframes listItem {
            from { opacity: 0; transform: translateX(-10px); }
            to { opacity: 1; transform: translateX(0); }
        }
        .recent-item img {
            width: 50px;
            height: 50px;
            border-radius: 20px;
            object-fit: cover;
            transition: 0.2s;
        }
        .recent-item:hover img {
            transform: scale(1.1);
        }
        .recent-info {
            flex: 1;
        }
        .recent-info h5 {
            font-weight: 600;
            font-size: 0.9rem;
        }
        .recent-info p {
            font-size: 0.7rem;
            color: #7a4f66;
        }
        .delete-btn {
            background: none;
            border: none;
            color: #ff8aa8;
            font-size: 1.2rem;
            cursor: pointer;
            transition: 0.2s;
        }
        .delete-btn:hover {
            color: #ff3b6f;
            transform: scale(1.2) rotate(10deg);
        }
        .upload-section {
            background: white;
            border-radius: 50px;
            padding: 20px;
            margin-top: 20px;
        }
        .upload-area {
            border: 2px dashed #ffb6c1;
            border-radius: 40px;
            padding: 20px;
            text-align: center;
            background: #fff2f7;
            margin-bottom: 15px;
            transition: 0.3s;
        }
        .upload-area:hover {
            border-color: #ff69b4;
            background: #ffe9f2;
            transform: scale(1.02);
        }
        #file-input {
            display: none;
        }
        .file-label {
            background: #ff69b4;
            color: white;
            padding: 12px 30px;
            border-radius: 60px;
            cursor: pointer;
            display: inline-block;
            font-weight: 600;
            transition: 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .file-label:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 10px 20px rgba(255,105,180,0.3);
        }
        #image-preview {
            max-width: 100%;
            max-height: 200px;
            margin-top: 15px;
            border-radius: 30px;
            display: none;
            border: 4px solid white;
            box-shadow: 0 0 15px rgba(255,105,180,0.3);
            transition: 0.3s;
        }
        #image-preview[src] {
            display: block;
        }
        .ratio-selector, .category-selector {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .ratio-btn, .category-btn {
            background: #ffe2ec;
            border: none;
            padding: 8px 18px;
            border-radius: 40px;
            font-weight: 600;
            color: #b34e7a;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .ratio-btn:hover, .category-btn:hover {
            background: #ffb6c1;
            transform: scale(1.05);
            box-shadow: 0 5px 10px rgba(255,105,180,0.2);
        }
        .ratio-btn.active, .category-btn.active {
            background: #ff69b4;
            color: white;
        }
        .meta-input {
            width: 100%;
            padding: 14px 20px;
            border: 2px solid #ffd0df;
            border-radius: 60px;
            margin-bottom: 15px;
            font-size: 1rem;
            transition: 0.3s;
        }
        .meta-input:focus {
            border-color: #ff69b4;
            box-shadow: 0 0 0 4px rgba(255,105,180,0.2);
            outline: none;
        }
        .upload-btn {
            background: #ff69b4;
            color: white;
            border: none;
            padding: 14px;
            border-radius: 60px;
            width: 100%;
            font-weight: 600;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .upload-btn:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 10px 20px rgba(255,105,180,0.3);
        }
        #password-modal {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.4);
            backdrop-filter: blur(15px);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s;
        }
        .password-card {
            background: white;
            border-radius: 70px;
            padding: 40px;
            max-width: 380px;
            text-align: center;
            box-shadow: 0 30px 50px rgba(255,20,120,0.3);
            animation: popIn 0.5s;
        }
        .password-card h2 {
            color: #ff69b4;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .password-input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #ffb6c1;
            border-radius: 60px;
            font-size: 1rem;
            margin-bottom: 20px;
            transition: 0.3s;
        }
        .password-input:focus {
            border-color: #ff69b4;
            box-shadow: 0 0 0 4px rgba(255,105,180,0.2);
            outline: none;
        }
        .password-btn {
            background: #ff69b4;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 60px;
            width: 100%;
            font-weight: 600;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .password-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(255,105,180,0.3);
        }
        .password-error {
            color: red;
            margin-top: 10px;
        }
        #confirm-modal {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.4);
            backdrop-filter: blur(10px);
            z-index: 2500;
            display: none;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s;
        }
        .confirm-card {
            background: white;
            border-radius: 60px;
            padding: 30px;
            max-width: 350px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(255,105,180,0.4);
            animation: popIn 0.4s;
        }
        .confirm-card h3 {
            color: #b34e7a;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .confirm-card p {
            margin-bottom: 25px;
            color: #7a4f66;
        }
        .confirm-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        .confirm-btn {
            padding: 12px 30px;
            border: none;
            border-radius: 60px;
            font-weight: 600;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .confirm-btn.yes {
            background: #ff69b4;
            color: white;
        }
        .confirm-btn.no {
            background: #e0b0c0;
            color: white;
        }
        .confirm-btn:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 5px 15px rgba(255,105,180,0.3);
        }
        .preview-modal {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(12px);
            z-index: 1500;
            display: none;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            animation: fadeIn 0.3s;
        }
        .preview-modal img {
            max-width: 90%;
            max-height: 70vh;
            border-radius: 50px;
            border: 5px solid white;
            animation: zoomIn 0.3s, borderGlow 2s infinite;
        }
        @keyframes borderGlow {
            0% { border-color: white; }
            50% { border-color: #ff69b4; }
            100% { border-color: white; }
        }
        .preview-caption {
            color: white;
            margin-top: 20px;
            font-size: 1.3rem;
            background: rgba(255,255,255,0.2);
            padding: 10px 30px;
            border-radius: 60px;
            backdrop-filter: blur(5px);
            animation: fadeIn 0.5s;
        }
        .close-preview {
            position: absolute;
            top: 30px;
            right: 40px;
            color: white;
            font-size: 4rem;
            cursor: pointer;
            transition: 0.2s;
        }
        .close-preview:hover {
            transform: scale(1.2) rotate(90deg);
            color: #ff69b4;
        }
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: #ff69b4;
            color: white;
            padding: 15px 35px;
            border-radius: 60px;
            box-shadow: 0 15px 30px rgba(255,80,130,0.5);
            z-index: 3000;
            display: none;
            font-weight: 600;
            animation: slideUp 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        @keyframes slideUp {
            from { transform: translate(-50%, 100%); opacity: 0; }
            to { transform: translate(-50%, 0%); opacity: 1; }
        }
        .click-love {
            position: fixed;
            pointer-events: none;
            font-size: 2rem;
            z-index: 10000;
            animation: clickLoveAnim 1s ease-out forwards;
        }
        @keyframes clickLoveAnim {
            0% { transform: scale(0.5) translateY(0); opacity: 1; }
            100% { transform: scale(2) translateY(-100px); opacity: 0; }
        }
        @media (max-width: 700px) {
            .navbar {
                flex-direction: column;
                align-items: stretch;
            }
            .nav-links {
                justify-content: center;
            }
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            .music-player {
                flex-direction: column;
                align-items: stretch;
            }
            .playlist {
                justify-content: center;
            }
            .page-title {
                font-size: 1.5rem;
                padding: 8px 20px;
            }
            .status-mini {
                gap: 15px;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="logo"><i class="fas fa-heart" style="color: #ff69b4;"></i>ñ¶Åssuccizkyyee</div>
        <div class="nav-links">
            <a href="#" class="nav-link active" data-page="gallery"><i class="fas fa-images"></i> Gallery</a>
            <a href="#" class="nav-link" data-page="dashboard"><i class="fas fa-lock"></i> Dashboard</a>
        </div>
    </nav>

    <!-- Status mini -->
    <div class="status-mini">
        <span><i class="fas fa-globe"></i> <span id="ip-address">-</span></span>
        <span><i class="fas fa-battery-three-quarters"></i> <span id="battery-level">-</span></span>
        <span><i class="fas fa-calendar-alt"></i> <span id="current-date">-</span></span>
    </div>

    <!-- Container utama -->
    <div class="container">
        <!-- HALAMAN GALLERY -->
        <div id="gallery-page" class="active-page">
            <div class="page-title">
                <i class="fas fa-camera-retro"></i> Gallery Kenangan
            </div>

            <!-- Music player -->
            <div class="music-player">
                <div class="music-controls">
                    <button class="music-btn" id="prev-btn"><i class="fas fa-backward"></i></button>
                    <button class="music-btn" id="play-pause-btn"><i class="fas fa-play"></i></button>
                    <button class="music-btn" id="next-btn"><i class="fas fa-forward"></i></button>
                </div>
                <div class="music-info" id="music-info">Perfect - Ed Sheeran</div>
                <div class="playlist">
                    <div class="playlist-item active" data-src="music/perfect.mp3" data-name="Perfect"><i class="fas fa-music"></i> Perfect</div>
                    <div class="playlist-item" data-src="music/blue.mp3" data-name="Blue"><i class="fas fa-music"></i> Blue</div>
                    <div class="playlist-item" data-src="music/sempurna.mp3" data-name="Sempurna"><i class="fas fa-music"></i> Sempurna</div>
                </div>
                <audio id="audio-player" src="music/perfect.mp3"></audio>
            </div>

            <!-- Inner tabs: Foto, Catatan, Quote -->
            <div class="gallery-inner-tabs">
                <span class="inner-tab active" data-inner="foto"><i class="fas fa-camera"></i> Foto</span>
                <span class="inner-tab" data-inner="catatan"><i class="fas fa-pen"></i> Catatan</span>
                <span class="inner-tab" data-inner="quote"><i class="fas fa-quote-right"></i> Bucin Quote</span>
            </div>

            <!-- Konten Foto -->
            <div id="foto-content" class="inner-content">
                <!-- Filter kategori foto -->
                <div style="display: flex; gap: 12px; margin-bottom: 20px; flex-wrap: wrap; align-items: center;">
                    <span class="gallery-tab active" data-filter="all" style="background: rgba(255,255,255,0.6); padding: 8px 20px; border-radius: 40px; cursor: pointer; display: flex; align-items: center; gap: 5px;"><i class="fas fa-list"></i> Semua</span>
                    <span class="gallery-tab" data-filter="suci" style="background: rgba(255,255,255,0.6); padding: 8px 20px; border-radius: 40px; cursor: pointer; display: flex; align-items: center; gap: 5px;"><i class="fas fa-female"></i> succi</span>
                    <span class="gallery-tab" data-filter="rizky" style="background: rgba(255,255,255,0.6); padding: 8px 20px; border-radius: 40px; cursor: pointer; display: flex; align-items: center; gap: 5px;"><i class="fas fa-male"></i> zkyye</span>
                    <span class="gallery-tab" data-filter="bareng" style="background: rgba(255,255,255,0.6); padding: 8px 20px; border-radius: 40px; cursor: pointer; display: flex; align-items: center; gap: 5px;"><i class="fas fa-heart"></i> Bareng</span>
                </div>
                <div class="gallery-grid" id="gallery-grid"></div>
                <div id="empty-gallery" class="empty-message" style="display: none;"><i class="fas fa-cloud-upload-alt"></i> Belum ada foto. Upload dari Dashboard ‚ú®</div>
            </div>

            <!-- Konten Catatan -->
            <div id="catatan-content" style="display: none;">
                <div class="notes-container" id="notes-list">
                    <!-- Catatan aktif akan muncul di sini -->
                </div>
                <div class="create-note">
                    <h3 style="margin-bottom: 15px; color: #b34e7a; display: flex; align-items: center; gap: 8px;"><i class="fas fa-pen-fancy"></i> Buat Catatan Sementara</h3>
                    <textarea id="new-note-text" placeholder="Tulis pesan untuk pasanganmu..." rows="3"></textarea>
                    <div class="timer-select" id="timer-options">
                        <span class="timer-option" data-minutes="1"><i class="far fa-clock"></i> 1 menit</span>
                        <span class="timer-option" data-minutes="10"><i class="far fa-clock"></i> 10 menit</span>
                        <span class="timer-option" data-minutes="30"><i class="far fa-clock"></i> 30 menit</span>
                        <span class="timer-option" data-minutes="60"><i class="far fa-clock"></i> 1 jam</span>
                        <span class="timer-option" data-minutes="120"><i class="far fa-clock"></i> 2 jam</span>
                        <span class="timer-option" data-minutes="180"><i class="far fa-clock"></i> 3 jam</span>
                        <span class="timer-option" data-minutes="360"><i class="far fa-clock"></i> 6 jam</span>
                        <span class="timer-option" data-minutes="720"><i class="far fa-clock"></i> 12 jam</span>
                        <span class="timer-option" data-days="2"><i class="far fa-calendar"></i> 2 hari</span>
                        <span class="timer-option" data-days="3"><i class="far fa-calendar"></i> 3 hari</span>
                        <span class="timer-option" data-days="7"><i class="far fa-calendar"></i> 7 hari</span>
                    </div>
                    <button id="create-note-btn"><i class="fas fa-hourglass-half"></i> Buat Catatan (akan otomatis kadaluarsa)</button>
                </div>
            </div>

            <!-- Konten Quote -->
            <div id="quote-content" style="display: none;">
                <div class="quote-container" id="quote-display">
                    <i class="fas fa-heart" style="color: #ff69b4;"></i> "setiap detik bersamamu adalah anugerah"
                </div>
                <div class="quote-actions">
                    <button class="new-quote-btn" id="new-quote"><i class="fas fa-sync-alt"></i> Quote Lainnya</button>
                    <button class="copy-quote-btn" id="copy-quote"><i class="fas fa-copy"></i> Salin Quote</button>
                </div>
            </div>
        </div>

        <!-- HALAMAN DASHBOARD -->
        <div id="dashboard-page">
            <div class="page-title"><i class="fas fa-heart"></i> Dashboard Cinta</div>
            <div class="dashboard-grid">
                <!-- Statistik -->
                <div class="card">
                    <div class="card-title"><i class="fas fa-chart-pie"></i> Statistik</div>
                    <div class="stats-row">
                        <div class="stat-item">
                            <div class="stat-value" id="stat-total">0</div>
                            <div class="stat-label">Total Foto</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="stat-today">0</div>
                            <div class="stat-label">Hari ini</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="stat-week">0</div>
                            <div class="stat-label">7 Hari</div>
                        </div>
                    </div>
                    <div style="margin-top: 20px; display: flex; justify-content: space-around;">
                        <div><i class="fas fa-female" style="color:#ff69b4;"></i> <span id="stat-suci">0</span></div>
                        <div><i class="fas fa-male" style="color:#ff69b4;"></i> <span id="stat-rizky">0</span></div>
                        <div><i class="fas fa-heart" style="color:#ff69b4;"></i> <span id="stat-bareng">0</span></div>
                    </div>
                </div>

                <!-- Grafik -->
                <div class="card">
                    <div class="card-title"><i class="fas fa-chart-line"></i> Aktivitas 7 Hari</div>
                    <div class="chart-container">
                        <canvas id="photoChart"></canvas>
                    </div>
                </div>

                <!-- Foto Terbaru -->
                <div class="card">
                    <div class="card-title"><i class="fas fa-clock"></i> Foto Terbaru</div>
                    <ul class="recent-list" id="recent-list"></ul>
                </div>

                <!-- Upload Foto -->
                <div class="card">
                    <div class="card-title"><i class="fas fa-cloud-upload-alt"></i> Upload Foto</div>
                    <div class="upload-section">
                        <div class="upload-area">
                            <input type="file" id="file-input" accept="image/*">
                            <label for="file-input" class="file-label"><i class="fas fa-camera"></i> Pilih Foto</label>
                            <img id="image-preview" src="#" alt="preview">
                        </div>
                        <!-- Pilihan Rasio -->
                        <div class="ratio-selector">
                            <button class="ratio-btn active" data-ratio="9:16"><i class="fas fa-mobile-alt"></i> 9:16</button>
                            <button class="ratio-btn" data-ratio="1:1"><i class="fas fa-square"></i> 1:1</button>
                            <button class="ratio-btn" data-ratio="4:3"><i class="fas fa-tablet-alt"></i> 4:3</button>
                        </div>
                        <!-- Pilihan Kategori -->
                        <div class="category-selector">
                            <button class="category-btn active" data-category="suci"><i class="fas fa-female"></i> succi</button>
                            <button class="category-btn" data-category="rizky"><i class="fas fa-male"></i> zkyye</button>
                            <button class="category-btn" data-category="bareng"><i class="fas fa-heart"></i> Bareng</button>
                        </div>
                        <input type="text" id="photo-title" class="meta-input" placeholder="Judul kenangan (wajib)">
                        <textarea id="photo-desc" class="meta-input" placeholder="Deskripsi (wajib)" rows="2"></textarea>
                        <button class="upload-btn" id="upload-btn"><i class="fas fa-heart"></i> Simpan ke Gallery</button>
                    </div>
                </div>

                <!-- Catatan Aktif -->
                <div class="card">
                    <div class="card-title"><i class="fas fa-sticky-note"></i> Catatan Aktif</div>
                    <div id="dashboard-notes-active" style="max-height: 200px; overflow-y: auto;">
                        <!-- Catatan yang belum expired -->
                    </div>
                </div>

                <!-- Catatan Kadaluarsa -->
                <div class="card">
                    <div class="card-title"><i class="fas fa-archive"></i> Catatan Lama (Kadaluarsa)</div>
                    <div id="dashboard-notes-expired" style="max-height: 200px; overflow-y: auto;">
                        <!-- Catatan yang sudah expired -->
                    </div>
                </div>

                <!-- Favorit -->
                <div class="card">
                    <div class="card-title"><i class="fas fa-star"></i> Favoritku</div>
                    <div class="stats-row">
                        <div class="stat-item">
                            <div class="stat-value" id="favorite-count">0</div>
                            <div class="stat-label">Favorit</div>
                        </div>
                    </div>
                    <div id="favorite-list" style="margin-top: 15px; max-height: 150px; overflow-y: auto;">
                        <!-- Daftar foto favorit -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL PASSWORD DASHBOARD -->
    <div id="password-modal">
        <div class="password-card">
            <h2><i class="fas fa-lock"></i> Dashboard Terkunci</h2>
            <p>Masukkan password spesial:</p>
            <input type="password" id="dashboard-password" class="password-input" placeholder="Password">
            <button class="password-btn" id="unlock-btn"><i class="fas fa-unlock-alt"></i> Buka Dashboard</button>
            <div id="password-error" class="password-error"></div>
        </div>
    </div>

    <!-- MODAL KONFIRMASI HAPUS -->
    <div id="confirm-modal">
        <div class="confirm-card">
            <h3><i class="fas fa-heart-broken"></i> Hapus Foto?</h3>
            <p>Foto ini akan hilang selamanya üò¢</p>
            <div class="confirm-buttons">
                <button class="confirm-btn yes" id="confirm-yes"><i class="fas fa-check"></i> Ya, Hapus</button>
                <button class="confirm-btn no" id="confirm-no"><i class="fas fa-times"></i> Batal</button>
            </div>
        </div>
    </div>

    <!-- Modal Preview Foto -->
    <div id="preview-modal" class="preview-modal">
        <span class="close-preview" id="close-preview">&times;</span>
        <img id="preview-image" src="">
        <div class="preview-caption" id="preview-caption"></div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast"></div>

    <script>
        (function() {
            // ================= DUA KONEKSI SUPABASE =================
            // Untuk Foto (project 1)
            const PHOTOS_URL = 'https://ltjhmgxxaiqpshmedvir.supabase.co';
            const PHOTOS_ANON = 'sb_publishable_XGhsGxJaYynamreM9zGabw_TZgKqG0P';

            // Untuk Catatan (project 2) - gunakan public anon key
            const NOTES_URL = 'https://pthnpzycimrowjjyihff.supabase.co';
            const NOTES_ANON = 'sb_publishable_QRwktq1psv_rDXzmGuoD2A_ZxOGfBa9';

            let supabasePhotos, supabaseNotes;
            let photosConnected = false, notesConnected = false;

            try {
                supabasePhotos = supabase.createClient(PHOTOS_URL, PHOTOS_ANON);
                photosConnected = true;
                console.log('‚úÖ Supabase Foto connected');
            } catch (e) {
                console.error('‚ùå Gagal koneksi Supabase Foto:', e);
            }

            try {
                supabaseNotes = supabase.createClient(NOTES_URL, NOTES_ANON);
                notesConnected = true;
                console.log('‚úÖ Supabase Catatan connected');
            } catch (e) {
                console.error('‚ùå Gagal koneksi Supabase Catatan:', e);
            }

            // ================= STATE =================
            let photos = [];
            let notes = [];
            let selectedFile = null;
            let selectedCategory = 'suci';
            let selectedRatio = '9:16';
            let currentFilter = 'all';
            let chartInstance = null;
            let dashboardUnlocked = false;
            let currentInnerTab = 'foto';

            // Favorit (disimpan di localStorage karena preferensi pengguna)
            let favorites = JSON.parse(localStorage.getItem('gallery_favorites') || '[]');

            // Music
            let currentMusicIndex = 0;
            const musicList = [
                { src: 'music/perfect.mp3', name: 'Perfect - Ed Sheeran' },
                { src: 'music/blue.mp3', name: 'Blue - Yung Kai' },
                { src: 'music/sempurna.mp3', name: 'Sempurna - Andra & The Backbone' }
            ];
            let audio = document.getElementById('audio-player');
            let isPlaying = false;

            // DOM
            const galleryPage = document.getElementById('gallery-page');
            const dashboardPage = document.getElementById('dashboard-page');
            const navLinks = document.querySelectorAll('.nav-link');
            const innerTabs = document.querySelectorAll('.inner-tab');
            const fotoContent = document.getElementById('foto-content');
            const catatanContent = document.getElementById('catatan-content');
            const quoteContent = document.getElementById('quote-content');
            const galleryGrid = document.getElementById('gallery-grid');
            const emptyGallery = document.getElementById('empty-gallery');
            const statTotal = document.getElementById('stat-total');
            const statToday = document.getElementById('stat-today');
            const statWeek = document.getElementById('stat-week');
            const statSuci = document.getElementById('stat-suci');
            const statRizky = document.getElementById('stat-rizky');
            const statBareng = document.getElementById('stat-bareng');
            const recentList = document.getElementById('recent-list');
            const fileInput = document.getElementById('file-input');
            const imagePreview = document.getElementById('image-preview');
            const photoTitle = document.getElementById('photo-title');
            const photoDesc = document.getElementById('photo-desc');
            const uploadBtn = document.getElementById('upload-btn');
            const previewModal = document.getElementById('preview-modal');
            const previewImage = document.getElementById('preview-image');
            const previewCaption = document.getElementById('preview-caption');
            const closePreview = document.getElementById('close-preview');
            const toast = document.getElementById('toast');
            const ipSpan = document.getElementById('ip-address');
            const batterySpan = document.getElementById('battery-level');
            const dateSpan = document.getElementById('current-date');
            const quoteDisplay = document.getElementById('quote-display');
            const newQuoteBtn = document.getElementById('new-quote');
            const copyQuoteBtn = document.getElementById('copy-quote');
            const notesList = document.getElementById('notes-list');
            const newNoteText = document.getElementById('new-note-text');
            const createNoteBtn = document.getElementById('create-note-btn');
            const timerOptions = document.querySelectorAll('.timer-option');
            const galleryTabs = document.querySelectorAll('.gallery-tab');
            const categoryBtns = document.querySelectorAll('.category-btn');
            const ratioBtns = document.querySelectorAll('.ratio-btn');
            const playPauseBtn = document.getElementById('play-pause-btn');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const musicInfo = document.getElementById('music-info');
            const playlistItems = document.querySelectorAll('.playlist-item');
            const passwordModal = document.getElementById('password-modal');
            const unlockBtn = document.getElementById('unlock-btn');
            const dashboardPassword = document.getElementById('dashboard-password');
            const passwordError = document.getElementById('password-error');
            const confirmModal = document.getElementById('confirm-modal');
            const confirmYes = document.getElementById('confirm-yes');
            const confirmNo = document.getElementById('confirm-no');
            const dashboardNotesActive = document.getElementById('dashboard-notes-active');
            const dashboardNotesExpired = document.getElementById('dashboard-notes-expired');
            const favoriteCount = document.getElementById('favorite-count');
            const favoriteList = document.getElementById('favorite-list');

            let pendingDeleteId = null; // untuk hapus foto

            // ========== HELPER ==========
            function showToast(msg, duration = 2000) {
                toast.innerHTML = `<i class="fas fa-heart"></i> ${msg}`;
                toast.style.display = 'flex';
                setTimeout(() => { toast.style.display = 'none'; }, duration);
            }

            // Efek love saat klik (ringan)
            document.addEventListener('click', function(e) {
                const love = document.createElement('div');
                love.className = 'click-love';
                love.innerHTML = '<i class="fas fa-heart" style="color: #ff69b4;"></i>';
                love.style.left = (e.pageX - 20) + 'px';
                love.style.top = (e.pageY - 20) + 'px';
                document.body.appendChild(love);
                setTimeout(() => love.remove(), 1000);
            });

            // Floating hearts (interval 600ms agar tidak lag)
            function createFloatingHeart() {
                const heart = document.createElement('div');
                heart.innerHTML = '<i class="fas fa-heart"></i>';
                heart.classList.add('heart-float');
                heart.style.left = Math.random() * 100 + '%';
                heart.style.fontSize = (Math.random() * 2 + 1) + 'rem';
                heart.style.animationDuration = (Math.random() * 5 + 5) + 's';
                document.body.appendChild(heart);
                setTimeout(() => heart.remove(), 10000);
            }
            setInterval(createFloatingHeart, 600);

            // ========== FUNGSI FOTO (menggunakan supabasePhotos) ==========
            async function loadPhotos() {
                if (!photosConnected) {
                    showToast('Koneksi database foto gagal');
                    return;
                }
                const { data, error } = await supabasePhotos
                    .from('photos')
                    .select('*')
                    .order('created_at', { ascending: false });
                if (error) {
                    console.error('Error loading photos:', error);
                    showToast('Gagal memuat foto');
                    photos = [];
                } else {
                    photos = data || [];
                }
                renderGallery();
                updateStats();
                updateRecentList();
                updateChart();
                updateFavoritesUI();
            }

            async function uploadImageToStorage(file) {
                const fileName = `${Date.now()}_${file.name.replace(/[^a-zA-Z0-9.]/g, '_')}`;
                const { data, error } = await supabasePhotos.storage.from('gallery').upload(fileName, file);
                if (error) throw error;
                const { data: urlData } = supabasePhotos.storage.from('gallery').getPublicUrl(fileName);
                return urlData.publicUrl;
            }

            async function uploadPhoto() {
                if (!photosConnected) { showToast('Database foto tidak tersedia'); return; }
                if (!selectedFile) { showToast('Pilih foto dulu'); return; }
                const title = photoTitle.value.trim();
                const desc = photoDesc.value.trim();
                if (!title || !desc) { showToast('Judul & deskripsi wajib'); return; }

                uploadBtn.disabled = true;
                uploadBtn.innerHTML = '<i class="fas fa-spinner fa-pulse"></i> Menyimpan...';

                try {
                    const imageUrl = await uploadImageToStorage(selectedFile);

                    const newPhoto = {
                        title,
                        description: desc,
                        image_url: imageUrl,
                        category: selectedCategory,
                        aspect_ratio: selectedRatio,
                        created_at: new Date().toISOString()
                    };

                    const { data, error } = await supabasePhotos.from('photos').insert([newPhoto]).select();
                    if (error) throw error;
                    if (data && data.length) {
                        photos = [data[0], ...photos];
                    }

                    showToast('‚ú® Foto tersimpan!');
                    selectedFile = null;
                    fileInput.value = '';
                    imagePreview.style.display = 'none';
                    photoTitle.value = '';
                    photoDesc.value = '';
                    loadPhotos();
                    for (let i=0; i<5; i++) setTimeout(createFloatingHeart, i*100);
                } catch (err) {
                    showToast('Gagal: ' + err.message);
                } finally {
                    uploadBtn.disabled = false;
                    uploadBtn.innerHTML = '<i class="fas fa-heart"></i> Simpan';
                }
            }

            async function deletePhoto(id) {
                if (!photosConnected) return;
                const photo = photos.find(p => p.id === id);
                if (photo) {
                    const urlParts = photo.image_url.split('/');
                    const fileName = urlParts[urlParts.length - 1];
                    await supabasePhotos.storage.from('gallery').remove([fileName]);
                }
                const { error } = await supabasePhotos.from('photos').delete().eq('id', id);
                if (error) {
                    showToast('Gagal hapus: ' + error.message);
                    return;
                }
                favorites = favorites.filter(fid => fid !== id);
                localStorage.setItem('gallery_favorites', JSON.stringify(favorites));
                loadPhotos();
                showToast('Foto dihapus');
            }

            // ========== FUNGSI CATATAN (menggunakan supabaseNotes) ==========
            async function loadNotes() {
                if (!notesConnected) {
                    showToast('Koneksi database catatan gagal');
                    return;
                }
                // Ambil semua catatan
                const { data, error } = await supabaseNotes
                    .from('notes')
                    .select('*')
                    .order('created_at', { ascending: false });

                if (error) {
                    // Jika tabel tidak ditemukan, tampilkan pesan khusus
                    if (error.message && error.message.includes('relation') && error.message.includes('does not exist')) {
                        showToast('Tabel "notes" belum dibuat. Silakan buat tabel di Supabase.');
                    } else {
                        console.error('Error loading notes:', error);
                        showToast('Gagal memuat catatan');
                    }
                    notes = [];
                } else {
                    notes = data || [];
                }
                renderNotes();
                updateDashboardNotes();
            }

            async function saveNote(text, minutes, durationLabel) {
                if (!notesConnected) { showToast('Database catatan tidak tersedia'); return; }
                const createdAt = new Date();
                const expiresAt = new Date(createdAt.getTime() + minutes * 60000).toISOString();

                const { data, error } = await supabaseNotes
                    .from('notes')
                    .insert([{
                        text: text,
                        created_at: createdAt.toISOString(),
                        expires_at: expiresAt,
                        duration_label: durationLabel
                    }])
                    .select();

                if (error) {
                    // Tangani error RLS atau tabel tidak ada
                    if (error.message && error.message.includes('row-level security policy')) {
                        showToast('RLS aktif. Nonaktifkan RLS atau buat policy insert di tabel notes.');
                    } else if (error.message && error.message.includes('relation') && error.message.includes('does not exist')) {
                        showToast('Tabel "notes" belum dibuat. Silakan buat tabel di Supabase.');
                    } else {
                        showToast('Gagal menyimpan catatan: ' + error.message);
                    }
                    return;
                }

                if (data && data.length) {
                    notes.unshift(data[0]);
                    renderNotes();
                    updateDashboardNotes();
                    showToast(`Catatan akan otomatis kadaluarsa dalam ${minutes} menit`);
                }
            }

            async function deleteNote(noteId) {
                if (!notesConnected) return;
                const { error } = await supabaseNotes.from('notes').delete().eq('id', noteId);
                if (error) {
                    showToast('Gagal hapus catatan: ' + error.message);
                    return;
                }
                notes = notes.filter(n => n.id !== noteId);
                renderNotes();
                updateDashboardNotes();
                showToast('Catatan dihapus');
            }

            // ========== RENDER GALLERY ==========
            function renderGallery() {
                let filtered = photos;
                if (currentFilter !== 'all') {
                    filtered = photos.filter(p => p.category === currentFilter);
                }
                if (filtered.length === 0) {
                    galleryGrid.innerHTML = '';
                    emptyGallery.style.display = 'block';
                    return;
                }
                emptyGallery.style.display = 'none';
                let html = '';
                filtered.forEach(p => {
                    const isFav = favorites.includes(p.id);
                    html += `
                        <div class="photo-card" data-id="${p.id}" data-url="${p.image_url}" data-title="${p.title}" data-desc="${p.description}">
                            <button class="favorite-btn ${isFav ? 'active' : ''}" data-id="${p.id}"><i class="fa${isFav ? 's' : 'r'} fa-star"></i></button>
                            <img src="${p.image_url}" alt="${p.title}" loading="lazy">
                            <div class="photo-info">
                                <h4>${p.title}</h4>
                                <p>${p.description}</p>
                            </div>
                        </div>
                    `;
                });
                galleryGrid.innerHTML = html;

                document.querySelectorAll('.photo-card').forEach(c => {
                    c.addEventListener('click', (e) => {
                        if (e.target.closest('.favorite-btn')) return;
                        previewImage.src = c.dataset.url;
                        previewCaption.textContent = `${c.dataset.title} ‚Äî ${c.dataset.desc}`;
                        previewModal.style.display = 'flex';
                    });
                });

                document.querySelectorAll('.favorite-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const id = btn.dataset.id;
                        toggleFavorite(id);
                    });
                });
            }

            // ========== TOGGLE FAVORITE ==========
            function toggleFavorite(photoId) {
                const index = favorites.indexOf(photoId);
                if (index === -1) {
                    favorites.push(photoId);
                    showToast('‚ù§Ô∏è Ditambahkan ke favorit!');
                } else {
                    favorites.splice(index, 1);
                    showToast('üíî Dihapus dari favorit');
                }
                localStorage.setItem('gallery_favorites', JSON.stringify(favorites));
                renderGallery();
                updateFavoritesUI();
            }

            // ========== UPDATE FAVORITE UI ==========
            function updateFavoritesUI() {
                favoriteCount.textContent = favorites.length;
                const favPhotos = photos.filter(p => favorites.includes(p.id));
                let html = '';
                favPhotos.slice(0, 5).forEach(p => {
                    html += `
                        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <img src="${p.image_url}" style="width: 40px; height: 40px; border-radius: 20px; object-fit: cover;">
                            <span style="font-size: 0.9rem;">${p.title}</span>
                        </div>
                    `;
                });
                favoriteList.innerHTML = html || '<p style="color: #7a4f66;">Belum ada favorit</p>';
            }

            // ========== RENDER NOTES (di gallery) hanya yang aktif ==========
            function renderNotes() {
                const now = Date.now();
                const activeNotes = notes.filter(n => {
                    const exp = new Date(n.expires_at).getTime();
                    return exp > now;
                });

                if (activeNotes.length === 0) {
                    notesList.innerHTML = '<div class="empty-message"><i class="fas fa-pen"></i> Belum ada catatan aktif. Buat catatan baru!</div>';
                    return;
                }
                let html = '';
                activeNotes.forEach(n => {
                    const exp = new Date(n.expires_at);
                    const nowDate = new Date();
                    const diffMs = exp - nowDate;
                    const diffMin = Math.floor(diffMs / 60000);
                    const diffHours = Math.floor(diffMin / 60);
                    const diffDays = Math.floor(diffHours / 24);

                    let timeText = '';
                    if (diffDays > 0) timeText = `${diffDays} hari lagi`;
                    else if (diffHours > 0) timeText = `${diffHours} jam ${diffMin % 60} menit lagi`;
                    else timeText = `${diffMin} menit lagi`;

                    html += `
                        <div class="note-card" data-id="${n.id}">
                            <div class="note-header">
                                <span class="note-time"><i class="far fa-calendar-alt"></i> ${new Date(n.created_at).toLocaleString()}</span>
                                <span class="note-timer"><i class="fas fa-hourglass-half"></i> ${timeText}</span>
                            </div>
                            <div class="note-content">${n.text}</div>
                        </div>
                    `;
                });
                notesList.innerHTML = html;
            }

            // ========== UPDATE DASHBOARD NOTES (aktif & expired) dengan info lengkap ==========
            function updateDashboardNotes() {
                const now = Date.now();
                const active = notes.filter(n => new Date(n.expires_at).getTime() > now);
                const expired = notes.filter(n => new Date(n.expires_at).getTime() <= now);

                let activeHtml = '';
                active.slice(0, 5).forEach(n => {
                    const created = new Date(n.created_at).toLocaleString();
                    const durasi = n.duration_label || '?';
                    activeHtml += `<div style="padding: 8px; border-bottom: 1px solid #ffb6c1; display: flex; justify-content: space-between; align-items: center;">
                        <span><i class="fas fa-sticky-note"></i> ${n.text.substring(0,30)}... <br><small>${created} (${durasi})</small></span>
                        <button class="note-delete-btn" data-id="${n.id}"><i class="fas fa-trash-alt"></i></button>
                    </div>`;
                });
                dashboardNotesActive.innerHTML = activeHtml || '<p>Tidak ada catatan aktif</p>';

                let expiredHtml = '';
                expired.slice(0, 5).forEach(n => {
                    const created = new Date(n.created_at).toLocaleString();
                    const durasi = n.duration_label || '?';
                    expiredHtml += `<div style="padding: 8px; border-bottom: 1px dashed #d3b0c0; display: flex; justify-content: space-between; align-items: center; opacity:0.7;">
                        <span><i class="fas fa-archive"></i> ${n.text.substring(0,30)}... <br><small>${created} (${durasi}) - EXPIRED</small></span>
                        <button class="note-delete-btn" data-id="${n.id}"><i class="fas fa-trash-alt"></i></button>
                    </div>`;
                });
                dashboardNotesExpired.innerHTML = expiredHtml || '<p>Tidak ada catatan lama</p>';

                // Event listener untuk tombol hapus catatan di dashboard
                document.querySelectorAll('#dashboard-notes-active .note-delete-btn, #dashboard-notes-expired .note-delete-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const id = btn.dataset.id;
                        if (confirm('Hapus catatan ini?')) {
                            deleteNote(id);
                        }
                    });
                });
            }

            // ========== UPDATE STATS ==========
            function updateStats() {
                const now = new Date();
                const todayStr = now.toDateString();
                const weekAgo = new Date(now.getTime() - 7*24*60*60*1000);
                let total = photos.length;
                let today = 0, week = 0;
                let suci = 0, rizky = 0, bareng = 0;
                photos.forEach(p => {
                    const d = new Date(p.created_at);
                    if (d.toDateString() === todayStr) today++;
                    if (d >= weekAgo) week++;
                    if (p.category === 'suci') suci++;
                    else if (p.category === 'rizky') rizky++;
                    else if (p.category === 'bareng') bareng++;
                });
                statTotal.textContent = total;
                statToday.textContent = today;
                statWeek.textContent = week;
                statSuci.textContent = suci;
                statRizky.textContent = rizky;
                statBareng.textContent = bareng;
            }

            // ========== UPDATE RECENT LIST ==========
            function updateRecentList() {
                const recent = photos.slice(0, 5);
                let html = '';
                recent.forEach(p => {
                    html += `
                        <li class="recent-item">
                            <img src="${p.image_url}" alt="">
                            <div class="recent-info">
                                <h5>${p.title}</h5>
                                <p>${new Date(p.created_at).toLocaleDateString('id-ID')}</p>
                            </div>
                            <button class="delete-btn" data-id="${p.id}"><i class="fas fa-trash-alt"></i></button>
                        </li>
                    `;
                });
                recentList.innerHTML = html;
                document.querySelectorAll('.delete-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const id = btn.dataset.id;
                        pendingDeleteId = id;
                        confirmModal.style.display = 'flex';
                    });
                });
            }

            // ========== UPDATE CHART ==========
            function updateChart() {
                const labels = [];
                const counts = [];
                for (let i = 6; i >= 0; i--) {
                    const d = new Date();
                    d.setDate(d.getDate() - i);
                    const dateStr = d.toDateString();
                    labels.push(d.toLocaleDateString('id-ID', { weekday: 'short' }));
                    const count = photos.filter(p => new Date(p.created_at).toDateString() === dateStr).length;
                    counts.push(count);
                }

                const ctx = document.getElementById('photoChart').getContext('2d');
                if (chartInstance) chartInstance.destroy();
                chartInstance = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Foto',
                            data: counts,
                            backgroundColor: '#ffb6c1',
                            borderRadius: 10,
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { display: false } }
                    }
                });
            }

            // ========== BUAT CATATAN BARU ==========
            function createNoteHandler() {
                const text = newNoteText.value.trim();
                if (!text) { showToast('Tulis catatan dulu'); return; }

                const selectedTimer = document.querySelector('.timer-option.active');
                if (!selectedTimer) { showToast('Pilih timer'); return; }

                let minutes = 0;
                if (selectedTimer.dataset.minutes) {
                    minutes = parseInt(selectedTimer.dataset.minutes);
                } else if (selectedTimer.dataset.days) {
                    minutes = parseInt(selectedTimer.dataset.days) * 24 * 60;
                }

                const durationLabel = selectedTimer.innerText.trim();
                saveNote(text, minutes, durationLabel);
                newNoteText.value = '';
            }

            // ========== STATUS BAR ==========
            async function updateIP() {
                try {
                    const res = await fetch('https://api.ipify.org?format=json');
                    const data = await res.json();
                    ipSpan.textContent = data.ip;
                } catch { ipSpan.textContent = 'unknown'; }
            }
            async function updateBattery() {
                try {
                    const battery = await navigator.getBattery();
                    const update = () => { batterySpan.textContent = Math.round(battery.level * 100) + '%'; };
                    update();
                    battery.addEventListener('levelchange', update);
                } catch { batterySpan.textContent = 'üåà'; }
            }
            function updateDateTime() {
                const d = new Date();
                dateSpan.textContent = d.toLocaleDateString('id-ID', { day:'numeric', month:'short', hour:'2-digit', minute:'2-digit' });
            }

            // ========== QUOTE ==========
            const quotes = [
                "setiap foto adalah bukti cinta kita",
                "kamu adalah alasan aku tersenyum",
                "aku suka kamu, hari ini dan selamanya",
                "bersamamu adalah rumah",
                "senyummu lebih indah dari sunset",
                "cintaku padamu sebesar galaxy",
                "kamu adalah kata sandi hatiku",
                "aku jatuh cinta setiap kali melihatmu",
                "bersamamu, waktu terasa cepat",
                "kamu adalah hadiah terindah",
                "kalau jadi bakso, kamu bakso yang bikin kangen",
                "aku nggak butuh sinyal, yang aku butuh kamu",
                "hatiku adalah WIFI, dan kamu adalah passwordnya"
            ];
            function randomQuote() {
                const quote = quotes[Math.floor(Math.random() * quotes.length)];
                quoteDisplay.innerHTML = `<i class="fas fa-heart" style="color: #ff69b4;"></i> "${quote}"`;
            }
            newQuoteBtn.addEventListener('click', randomQuote);
            copyQuoteBtn.addEventListener('click', () => {
                const text = quoteDisplay.innerText.replace(/[‚ù§Ô∏è"]/g, '').trim();
                navigator.clipboard.writeText(text).then(() => {
                    showToast('Quote disalin!');
                });
            });

            // ========== MUSIC ==========
            function loadMusic(index) {
                const music = musicList[index];
                audio.src = music.src;
                musicInfo.textContent = music.name;
                playlistItems.forEach((item, i) => {
                    if (i === index) item.classList.add('active');
                    else item.classList.remove('active');
                });
                if (isPlaying) {
                    audio.play();
                    playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
                } else {
                    audio.pause();
                    playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
                }
            }
            playPauseBtn.addEventListener('click', () => {
                if (isPlaying) {
                    audio.pause();
                    playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
                } else {
                    audio.play();
                    playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
                }
                isPlaying = !isPlaying;
            });
            prevBtn.addEventListener('click', () => {
                currentMusicIndex = (currentMusicIndex - 1 + musicList.length) % musicList.length;
                loadMusic(currentMusicIndex);
                if (isPlaying) audio.play();
            });
            nextBtn.addEventListener('click', () => {
                currentMusicIndex = (currentMusicIndex + 1) % musicList.length;
                loadMusic(currentMusicIndex);
                if (isPlaying) audio.play();
            });
            playlistItems.forEach((item, idx) => {
                item.addEventListener('click', () => {
                    currentMusicIndex = idx;
                    loadMusic(currentMusicIndex);
                    if (!isPlaying) {
                        audio.play();
                        isPlaying = true;
                        playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
                    } else {
                        audio.play();
                    }
                });
            });
            audio.addEventListener('ended', () => {
                nextBtn.click();
            });
            loadMusic(0);

            // ========== NAVIGASI & PASSWORD ==========
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const page = link.dataset.page;
                    if (page === 'dashboard' && !dashboardUnlocked) {
                        passwordModal.style.display = 'flex';
                        return;
                    }
                    setActivePage(page);
                });
            });

            function setActivePage(page) {
                navLinks.forEach(l => l.classList.remove('active'));
                document.querySelector(`.nav-link[data-page="${page}"]`).classList.add('active');
                if (page === 'gallery') {
                    galleryPage.classList.add('active-page');
                    dashboardPage.classList.remove('active-page');
                } else {
                    galleryPage.classList.remove('active-page');
                    dashboardPage.classList.add('active-page');
                    if (dashboardUnlocked) {
                        updateStats();
                        updateRecentList();
                        updateChart();
                        updateDashboardNotes();
                        updateFavoritesUI();
                    }
                }
            }

            unlockBtn.addEventListener('click', () => {
                if (dashboardPassword.value === 'SuciLovee') {
                    dashboardUnlocked = true;
                    passwordModal.style.display = 'none';
                    setActivePage('dashboard');
                } else {
                    passwordError.textContent = 'Password salah, coba lagi.';
                }
            });

            window.addEventListener('click', (e) => {
                if (e.target === passwordModal) passwordModal.style.display = 'none';
            });

            // Inner tabs
            innerTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    innerTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    const inner = tab.dataset.inner;
                    currentInnerTab = inner;
                    fotoContent.style.display = inner === 'foto' ? 'block' : 'none';
                    catatanContent.style.display = inner === 'catatan' ? 'block' : 'none';
                    quoteContent.style.display = inner === 'quote' ? 'block' : 'none';
                    if (inner === 'catatan') loadNotes();
                    if (inner === 'quote') randomQuote();
                });
            });

            // Filter foto
            galleryTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    galleryTabs.forEach(t => {
                        t.style.background = 'rgba(255,255,255,0.6)';
                        t.style.color = '#b34e7a';
                    });
                    tab.style.background = '#ff69b4';
                    tab.style.color = 'white';
                    currentFilter = tab.dataset.filter;
                    renderGallery();
                });
            });

            // Timer options
            timerOptions.forEach(opt => {
                opt.addEventListener('click', () => {
                    timerOptions.forEach(o => o.classList.remove('active'));
                    opt.classList.add('active');
                });
            });

            // Category upload
            categoryBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    categoryBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    selectedCategory = btn.dataset.category;
                });
            });

            // Ratio buttons
            ratioBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    ratioBtns.forEach(r => r.classList.remove('active'));
                    btn.classList.add('active');
                    selectedRatio = btn.dataset.ratio;
                });
            });

            // File input preview
            fileInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (!file) return;
                selectedFile = file;
                const reader = new FileReader();
                reader.onload = ev => { imagePreview.src = ev.target.result; imagePreview.style.display = 'block'; };
                reader.readAsDataURL(file);
            });

            uploadBtn.addEventListener('click', uploadPhoto);
            createNoteBtn.addEventListener('click', createNoteHandler);

            // Preview modal close
            closePreview.addEventListener('click', () => { previewModal.style.display = 'none'; });
            window.addEventListener('click', (e) => { if (e.target === previewModal) previewModal.style.display = 'none'; });

            // ========== MODAL KONFIRMASI HAPUS FOTO ==========
            confirmNo.addEventListener('click', () => {
                confirmModal.style.display = 'none';
                pendingDeleteId = null;
            });
            confirmYes.addEventListener('click', () => {
                if (pendingDeleteId) {
                    deletePhoto(pendingDeleteId);
                    pendingDeleteId = null;
                }
                confirmModal.style.display = 'none';
            });
            window.addEventListener('click', (e) => {
                if (e.target === confirmModal) {
                    confirmModal.style.display = 'none';
                    pendingDeleteId = null;
                }
            });

            // ========== INIT ==========
            window.addEventListener('load', async () => {
                if (photosConnected) await loadPhotos();
                if (notesConnected) await loadNotes();
                updateIP();
                updateBattery();
                updateDateTime();
                setInterval(updateDateTime, 1000);
                randomQuote();

                timerOptions[1]?.classList.add('active'); // default 10 menit

                // Update catatan setiap 30 detik
                setInterval(async () => {
                    if (notesConnected) await loadNotes();
                }, 30000);
            });
        })();
    </script>
</body>
</html>
